# AMAS to IQ-TREE Partition Converter

This repository provides a simple Python script to convert partition
files generated by [AMAS](https://github.com/marekborowiec/AMAS) (in
NEXUS format) into the plain text format required by [IQ-TREE
3](http://www.iqtree.org/).

AMAS generates partition files like this:

    begin sets;
        charset 'locus1.fasta' = 1-100;
        charset 'locus2.fasta' = 101-250;
    end;

But IQ-TREE 3 expects them like this:

    DNA, locus1 = 1-100
    DNA, locus2 = 101-250

## Usage

1.  Save the script below as `fix_charsets.py`.

2.  Run it from the terminal:

``` bash
python fix_charsets.py concatenated_alignment.charsets
```

3.  It will generate a new file:

```{=html}
<!-- -->
```
    concatenated_alignment_iqtree.charsets

## Script: `fix_charsets.py`

``` python
import sys
import re

if len(sys.argv) != 2:
    print("Usage: python fix_charsets.py input.charsets")
    sys.exit(1)

input_path = sys.argv[1]
if not input_path.endswith(".charsets"):
    print("File must end with .charsets")
    sys.exit(1)

output_path = input_path.replace(".charsets", "_iqtree.charsets")

with open(input_path, "r", encoding="utf-8") as f:
    lines = f.readlines()

converted = []
for line in lines:
    match = re.match(r"charset\s+'?([\w\-.]+)\.fasta'?\s*=\s*(\d+-\d+);", line)
    if match:
        gene, coords = match.groups()
        converted.append(f"DNA, {gene} = {coords}")

if not converted:
    print("⚠️ No valid partitions found. Check your input format.")
    sys.exit(1)

with open(output_path, "w", encoding="utf-8") as f:
    f.write("\n".join(converted))

print(f"✅ Converted file saved as: {output_path}")
```

## License

MIT License
